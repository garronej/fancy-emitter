<form onsubmit="return false">
    <input id="txt" autofocus />
    <button type="submit" id="activate">Activate</button>
    <button type="reset" id="deactivate">Dectivate</button>
    <button type="reset" id="cancel">Cancel</button>
</form>
<hr/>
<pre id="log1"></pre>
<hr/>
<pre id="log2"></pre>

<script type="module">
    import {Emitter} from 'https://unpkg.com/fancy-emitter/dist/esm/index.js'

    const emitter = new Emitter

    document.getElementById('activate').onclick = () => emitter.activate(document.getElementById('txt').value)
    document.getElementById('deactivate').onclick = () => emitter.deactivate(Error('stopped by user'))
    document.getElementById('cancel').onclick = () => emitter.cancel()

    function log(element, data) {
        element.innerHTML += '\n' + data
    }

    async function start(element) {
        log(element, 'START')
        try {
            for await (const data of emitter)
                log(element, `>\t${data}`)
        } catch (error) {
            log(element, `ERR >\t${error}`)
        }
        log(element, 'FINISH')
    }

    start(document.getElementById('log1'))
    start(document.getElementById('log2'))
</script>
